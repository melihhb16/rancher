<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<title>Token ‚Üí WAX ‚Üí USD G√ºnl√ºk Kazan√ß Hesaplama</title>
<style>
  body { font-family: Arial, sans-serif; padding: 24px; background: #f7f8fa; }
  h1 { font-size: 1.6rem; margin-bottom: 12px; }
  label { display: block; margin-top: 12px; font-weight: 500; }
  input { width: 160px; padding: 6px 8px; margin-top: 4px; border: 1px solid #d0d4d9; border-radius: 6px; }
  button { margin-top: 18px; padding: 10px 16px; font-size: 15px; border: none; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,.08); cursor: pointer; background:#2563eb; color:#fff; }
  #result { margin-top: 24px; font-size: 1.2rem; font-weight: 600; color:#111827; }
  p.hint { font-size: 0.88rem; color: #6b7280; margin-top: 4px; max-width: 650px; }
</style>
<script>
  // Token ID'leri
  const TOKEN_IDS = {
    rcoin: 'rcoin-ranchersbank',
    ranch: 'ranch-ranchersbank',
    tool: 'tool-ranchersbank',
    farm: 'farm-ranchersbank'
  };

  // √úretim & t√ºketim (g√ºnl√ºk)
  const PRODUCTION = {
    ranch: 55 * 24, // saatlik 55 ranch x 24 saat
    rcoin: 4,       // 24 saatte 2-6 arasƒ± ortalama 4
  };

  const CONSUMPTION = {
    farm: 12 * 24 + 5 * 24, // toplam farm t√ºketimi (item1 + item2)
    tool: 9 * 24 + 1 * 24   // toplam tool t√ºketimi (item1 + item2)
  };

  const FEE_PERCENT = 6; // %6 fee

  // Sayƒ± √ßevirici
  function toNumber(v){ return parseFloat(v) || 0; }

  // Fiyatlarƒ± √ßek
  async function fetchPrices() {
    const prices = {};
    try {
      for (const [key, id] of Object.entries(TOKEN_IDS)) {
        const res = await fetch(`https://api.alcor.exchange/api/v2/tokens/${id}`);
        const data = await res.json();
        prices[key] = {
          wax: data.system_price,
          usd: data.usd_price
        };
        document.getElementById(key + 'Wax').value = prices[key].wax.toFixed(6);
        document.getElementById(key + 'Usd').value = prices[key].usd.toFixed(6);
      }
    } catch (e) {
      alert('Fiyatlar alƒ±namadƒ±. L√ºtfen internet baƒülantƒ±nƒ±zƒ± kontrol edin veya daha sonra tekrar deneyin.');
      console.error(e);
    }
    calculate(prices);
  }

  // Hesaplama fonksiyonu
  function calculate(prices = null) {
    // Eƒüer prices objesi yoksa inputlardan al
    if(!prices){
      prices = {
        ranch: { wax: toNumber(document.getElementById('ranchWax').value) },
        rcoin: { wax: toNumber(document.getElementById('rcoinWax').value) },
        farm: { wax: toNumber(document.getElementById('farmWax').value) },
        tool: { wax: toNumber(document.getElementById('toolWax').value) },
      };
    }

    const feeFactor = (100 - toNumber(document.getElementById('fee').value)) / 100;

    const revenueWax = feeFactor * (PRODUCTION.ranch * prices.ranch.wax + PRODUCTION.rcoin * prices.rcoin.wax);
    const costWax = CONSUMPTION.farm * prices.farm.wax + CONSUMPTION.tool * prices.tool.wax;
    const netWax = revenueWax - costWax;

    const waxUsd = toNumber(document.getElementById('waxUsd').value);
    const netUsd = netWax * waxUsd;

    document.getElementById('result').innerHTML = `
      <div>Net kazan√ß: <strong>${netWax.toFixed(4)} WAX</strong> / g√ºn</div>
      <div>‚âà <strong>${netUsd.toFixed(2)} USD</strong> / g√ºn</div>
    `;
  }

  // Sayfa y√ºklendiƒüinde fiyatlarƒ± √ßek ve hesapla
  window.addEventListener('load', () => {
    // WAX/USD fiyatƒ±nƒ± CoinGecko‚Äôdan √ßek
    fetch('https://api.coingecko.com/api/v3/simple/price?ids=wax&vs_currencies=usd')
      .then(res => res.json())
      .then(data => {
        if(data && data.wax && data.wax.usd){
          document.getElementById('waxUsd').value = data.wax.usd.toFixed(4);
        }
      })
      .catch(console.error);

    fetchPrices();
  });
</script>
</head>
<body>
  <h1>Token ‚Üí WAX ‚Üí USD G√ºnl√ºk Kazan√ß Hesaplama</h1>
  <p class="hint">Fiyatlar otomatik √ßekilir. ƒ∞stersen fiyatlarƒ± elle deƒüi≈ütirebilir ve <strong>Hesapla</strong> tu≈üuna basabilirsin.</p>

  <div>
    <label>Ranch fiyatƒ± (WAX)
      <input id="ranchWax" type="number" step="0.000001" />
    </label>
    <label>Ranch fiyatƒ± (USD)
      <input id="ranchUsd" type="number" step="0.000001" disabled />
    </label>

    <label>Rcoin fiyatƒ± (WAX)
      <input id="rcoinWax" type="number" step="0.000001" />
    </label>
    <label>Rcoin fiyatƒ± (USD)
      <input id="rcoinUsd" type="number" step="0.000001" disabled />
    </label>

    <label>Farm fiyatƒ± (WAX)
      <input id="farmWax" type="number" step="0.000001" />
    </label>
    <label>Farm fiyatƒ± (USD)
      <input id="farmUsd" type="number" step="0.000001" disabled />
    </label>

    <label>Tool fiyatƒ± (WAX)
      <input id="toolWax" type="number" step="0.000001" />
    </label>
    <label>Tool fiyatƒ± (USD)
      <input id="toolUsd" type="number" step="0.000001" disabled />
    </label>

    <label>√áekim √ºcreti (%)
      <input id="fee" type="number" step="0.1" value="6" />
    </label>

    <label>1 WAX ka√ß USD?
      <input id="waxUsd" type="number" step="0.0001" />
    </label>

    <button onclick="calculate()">üßÆ Hesapla</button>
    <button onclick="fetchPrices()">‚¨áÔ∏è Fiyatlarƒ± G√ºncelle</button>
  </div>

  <div id="result" style="margin-top:12px">Net kazan√ß burada g√∂r√ºnecek.</div>
</body>
</html>